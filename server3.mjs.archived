This file (server3.mjs) has been archived to archived_files_for_rewrite/server3.mjs due to its central role and the need for a more robust implementation of state management and error handling. It needs to be rewritten from scratch.
